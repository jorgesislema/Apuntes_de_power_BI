# Anatom√≠a del Editor de Power Query

## Introducci√≥n al Editor de Power Query

Power Query es el motor de transformaci√≥n de datos de Power BI, proporcionando una interfaz visual intuitiva para conectar, transformar y preparar datos de m√∫ltiples fuentes. Su editor es una herramienta sofisticada que combina facilidad de uso con capacidades avanzadas de ETL.

## Acceso al Editor

El Editor de Power Query es una herramienta integrada tanto en Power BI Desktop como en Excel. Su acceso est√° dise√±ado para ser r√°pido y contextual, permitiendo a los usuarios iniciar el proceso de transformaci√≥n de datos desde varios puntos de entrada.

### Desde Power BI Desktop

Power BI Desktop es el entorno principal para el desarrollo de informes, y el acceso al Editor de Power Query es una acci√≥n fundamental en el flujo de trabajo.

#### 1. Bot√≥n "Transformar datos" en la Cinta de Opciones (Home)
**Definici√≥n:** Es el punto de acceso m√°s directo y com√∫n. Un solo clic en este bot√≥n abre la ventana del Editor de Power Query, cargando todas las consultas existentes en el modelo de datos.

**Importancia Estrat√©gica:** Proporciona un punto de entrada centralizado y visible para la preparaci√≥n de datos, reforzando la idea de que la transformaci√≥n de datos es un paso previo y esencial a la visualizaci√≥n.

**M√©todo:**
1.  Abrir Power BI Desktop.
2.  Navegar a la pesta√±a "Inicio" (Home) en la cinta de opciones superior.
3.  Hacer clic en el bot√≥n "Transformar datos".

**Ejemplo Pr√°ctico:** Un analista ha cargado tres tablas desde una base de datos SQL, pero sabe que contienen valores nulos y errores. Utiliza el bot√≥n "Transformar datos" para abrir el editor y comenzar el proceso de limpieza antes de crear cualquier visualizaci√≥n.

#### 2. Men√∫ Contextual de una Consulta
**Definici√≥n:** Permite editar una consulta espec√≠fica directamente desde el panel de campos en la vista de Informe o Datos de Power BI Desktop.

**Importancia Estrat√©gica:** Ofrece un acceso r√°pido y contextual para modificar una consulta individual sin necesidad de navegar por todas las consultas en el editor principal. Es ideal para ajustes r√°pidos.

**M√©todo:**
1.  En la vista de "Informe" o "Datos" de Power BI Desktop, localizar el panel "Campos" (Fields) a la derecha.
2.  Hacer clic derecho sobre el nombre de la tabla (consulta) que se desea editar.
3.  Seleccionar la opci√≥n "Editar consulta" (Edit Query) en el men√∫ contextual.

**Ejemplo Pr√°ctico:** Mientras construye un gr√°fico, un analista nota que una columna de una tabla espec√≠fica tiene un nombre incorrecto. En lugar de abrir el editor completo, hace clic derecho en la tabla en el panel de campos y selecciona "Editar consulta" para renombrar la columna r√°pidamente.

#### 3. Flujo de "Obtener datos"
**Definici√≥n:** Al conectarse a una nueva fuente de datos, Power BI ofrece la opci√≥n de cargar los datos directamente o transformarlos primero. La segunda opci√≥n abre el Editor de Power Query.

**Importancia Estrat√©gica:** Integra la transformaci√≥n de datos como un paso natural en el proceso de importaci√≥n, permitiendo al usuario perfilar y limpiar los datos inmediatamente despu√©s de la conexi√≥n, antes de que impacten el modelo.

**M√©todo:**
1.  Hacer clic en "Obtener datos" (Get Data) y seleccionar una fuente.
2.  En la ventana del Navegador, seleccionar las tablas o elementos a importar.
3.  En lugar de hacer clic en "Cargar" (Load), hacer clic en el bot√≥n "Transformar datos" (Transform Data).

**Ejemplo Pr√°ctico:** Un usuario se conecta a un archivo Excel. En la vista previa del Navegador, observa que la primera fila contiene los encabezados, pero Power BI no lo ha detectado autom√°ticamente. Elige "Transformar datos" para abrir el editor y usar la opci√≥n "Usar la primera fila como encabezado".

### Desde Excel

Power Query est√° profundamente integrado en Excel (a partir de la versi√≥n 2016, conocido como "Obtener y transformar datos"), proporcionando las mismas capacidades de ETL que en Power BI.

#### 1. Pesta√±a "Datos" ‚Üí "Obtener datos"
**Definici√≥n:** Es el flujo de trabajo est√°ndar en Excel para iniciar el proceso de importaci√≥n y transformaci√≥n.

**Importancia Estrat√©gica:** Permite a los usuarios de Excel aprovechar la potencia de Power Query para automatizar tareas de limpieza de datos que tradicionalmente se hac√≠an con f√≥rmulas y macros complejas y fr√°giles.

**M√©todo:**
1.  Abrir Excel.
2.  Ir a la pesta√±a "Datos" (Data).
3.  En el grupo "Obtener y transformar datos" (Get & Transform Data), hacer clic en "Obtener datos" (Get Data) para conectarse a una fuente.
4.  Al igual que en Power BI, la ventana del Navegador permitir√° elegir "Transformar datos" para abrir el Editor de Power Query.

**Ejemplo Pr√°ctico:** Un contable recibe mensualmente un extracto bancario en formato CSV. Utiliza "Datos" > "Desde texto/CSV" en Excel y elige "Transformar datos" para abrir Power Query, donde puede eliminar columnas innecesarias, dividir conceptos y filtrar transacciones, automatizando un proceso que antes le llevaba horas de trabajo manual.

## Arquitectura del Editor

### Interfaz Principal
```
‚îå‚îÄ Cinta de Opciones ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îú‚îÄ Panel de Consultas ‚îÄ‚î¨‚îÄ √Årea de Vista Previa ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                      ‚îÇ                                ‚îÇ
‚îÇ ‚Ä¢ Query1             ‚îÇ Tabla con datos                ‚îÇ
‚îÇ ‚Ä¢ Query2             ‚îÇ transformados                  ‚îÇ
‚îÇ ‚Ä¢ Par√°metros         ‚îÇ                                ‚îÇ
‚îÇ                      ‚îÇ                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ Panel de Propiedades ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Pasos aplicados:                                      ‚îÇ
‚îÇ ‚Ä¢ Source                                              ‚îÇ
‚îÇ ‚Ä¢ Changed Type                                        ‚îÇ
‚îÇ ‚Ä¢ Filtered Rows                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Panel de Consultas

El Panel de Consultas, ubicado en el lado izquierdo del Editor de Power Query, es el centro de mando para gestionar todas las conexiones de datos, funciones y par√°metros del proyecto. Su correcta organizaci√≥n es clave para mantener la claridad y la mantenibilidad en modelos de datos complejos.

### Organizaci√≥n Jer√°rquica

Power Query permite y fomenta la organizaci√≥n de las consultas en grupos, creando una estructura l√≥gica que refleja el flujo de datos o las √°reas de negocio.

**Definici√≥n:** Es la capacidad de agrupar consultas, funciones y par√°metros en carpetas y subcarpetas. Esta organizaci√≥n no afecta a la ejecuci√≥n de las consultas, pero es fundamental para la legibilidad y el mantenimiento del proyecto.

**Importancia Estrat√©gica:** En proyectos con decenas o cientos de consultas, una buena organizaci√≥n jer√°rquica evita la confusi√≥n, facilita la localizaci√≥n de elementos espec√≠ficos y ayuda a otros desarrolladores (o a uno mismo en el futuro) a entender la l√≥gica del modelo de datos de un vistazo.

**M√©todos y T√©cnicas:**
- **Crear Grupos:** Clic derecho en el panel de consultas ‚Üí "Nuevo Grupo".
- **Mover a Grupo:** Arrastrar y soltar consultas dentro de los grupos o usar el men√∫ contextual.
- **Nomenclatura L√≥gica:** Nombrar los grupos de forma descriptiva (ej. "01_Fuentes", "02_Transformaciones", "03_ModeloFinal", "Funciones", "Par√°metros").

**Ejemplo Pr√°ctico:** Un analista est√° construyendo un modelo de ventas. Crea un grupo llamado "Fuentes" donde coloca las consultas que se conectan directamente a los sistemas de origen (SQL, Excel). Luego, crea un grupo "Transformaciones" donde guarda consultas intermedias que referencian a las fuentes para limpiar y dar forma a los datos. Finalmente, un grupo "Modelo" contiene las tablas finales que se cargar√°n en Power BI, que a su vez referencian a las consultas del grupo "Transformaciones".

### Iconos y Estados

Cada elemento en el panel de consultas tiene un icono que identifica su tipo y, a veces, su estado, proporcionando informaci√≥n visual r√°pida.

- **üìä Tabla (Query):** Representa una consulta est√°ndar que, si se ejecuta correctamente, devuelve un resultado tabular (una tabla). Es el tipo m√°s com√∫n.
- **fx Funci√≥n (Function):** Indica una funci√≥n personalizada, un bloque de c√≥digo M reutilizable que puede ser invocado desde otras consultas. Suelen agruparse en una carpeta "Funciones".
- **‚öôÔ∏è Par√°metro (Parameter):** Representa un valor de entrada configurable que puede ser utilizado en m√∫ltiples consultas. Permite cambiar din√°micamente aspectos como rutas de archivos, fechas de corte o nombres de servidor sin modificar el c√≥digo de las consultas.
- **‚ö†Ô∏è Error:** Este icono de advertencia aparece superpuesto al icono de la consulta si se ha producido un error durante la √∫ltima evaluaci√≥n o actualizaci√≥n. Al seleccionar la consulta, el √°rea de vista previa mostrar√° los detalles del error.
- **üîÑ Actualizando:** Un icono animado que indica que la consulta se est√° ejecutando actualmente, ya sea para obtener una vista previa o durante una actualizaci√≥n de datos.

### Operaciones de Consulta

El men√∫ contextual (clic derecho) sobre una consulta ofrece un conjunto de acciones cr√≠ticas para el desarrollo y la gesti√≥n de datos.

- **Editar:** Abre la consulta seleccionada para modificar sus pasos.
- **Duplicar:** Crea una copia exacta e independiente de la consulta, incluyendo todos sus pasos aplicados. √ötil para crear una nueva tabla basada en una l√≥gica existente pero con modificaciones.
- **Referencia:** Crea una nueva consulta que comienza con el resultado final de la consulta referenciada. Es la forma m√°s eficiente de construir flujos de datos modulares, donde una consulta base sirve de punto de partida para m√∫ltiples transformaciones posteriores.
- **Habilitar Carga (Enable Load):** Controla si el resultado de la consulta se cargar√° en el modelo de datos final (ej. en Power BI o en una hoja de Excel). Se deshabilita para consultas intermedias ("staging queries") que solo sirven como pasos previos para otras, optimizando as√≠ el uso de memoria.
- **Incluir en la Actualizaci√≥n del Informe (Include in Report Refresh):** Determina si la consulta se actualizar√° cuando se inicie una actualizaci√≥n de datos. Se puede deshabilitar para tablas que contienen datos est√°ticos que no cambian con el tiempo.
- **Eliminar:** Borra la consulta del modelo.
- **Editor Avanzado (Advanced Editor):** Abre el editor de c√≥digo M, mostrando el script completo que generan los pasos aplicados. Permite realizar modificaciones complejas que no son posibles a trav√©s de la interfaz gr√°fica.
- **Propiedades:** Permite cambiar el nombre de la consulta y a√±adir una descripci√≥n, una pr√°ctica muy recomendada para documentar el prop√≥sito de cada consulta.

## √Årea de Vista Previa

El √Årea de Vista Previa es el coraz√≥n visual del Editor de Power Query. Ocupa la mayor parte de la interfaz y muestra una muestra representativa de los datos a medida que se aplican las transformaciones. Es un entorno interactivo que no solo visualiza los datos, sino que tambi√©n sirve como una superficie de trabajo principal para aplicar muchas de las transformaciones.

### Funcionalidades Principales

Esta √°rea proporciona una visi√≥n din√°mica y funcional de los datos.

-   **Vista de datos en tiempo real:** Muestra el resultado de los pasos de transformaci√≥n aplicados hasta el momento. Por defecto, carga las primeras 1000 filas para mantener la agilidad de la interfaz.
-   **Encabezados de columna interactivos:** Los encabezados no son solo etiquetas; son men√∫s y puntos de interacci√≥n para realizar operaciones a nivel de columna.
-   **Detecci√≥n autom√°tica de tipos de datos:** Power Query analiza las primeras filas y asigna un tipo de dato (texto, n√∫mero, fecha) a cada columna, representado por un icono.
-   **Resaltado de errores y nulos:** Proporciona feedback visual inmediato sobre la calidad de los datos, mostrando los errores en rojo y los valores nulos en gris, a menudo con patrones para indicar su naturaleza.

### Interacciones de Columna

La mayor parte del trabajo de transformaci√≥n se puede iniciar directamente desde las columnas en el √°rea de vista previa.

#### Men√∫ Contextual del Encabezado de Columna

Al hacer clic derecho en el encabezado de una columna, se despliega un men√∫ contextual con las transformaciones m√°s comunes para esa columna.

**Definici√≥n:** Es un men√∫ emergente que ofrece un acceso r√°pido a un amplio conjunto de operaciones espec√≠ficas de la columna seleccionada.

**Importancia Estrat√©gica:** Acelera enormemente el desarrollo al agrupar las acciones m√°s relevantes en un solo lugar, evitando la necesidad de buscarlas en la cinta de opciones. Fomenta un flujo de trabajo de "seleccionar y transformar".

**Operaciones Comunes:**
-   **Quitar (Remove):** Elimina la columna seleccionada.
-   **Quitar Otras (Remove Other Columns):** Elimina todas las columnas excepto la(s) seleccionada(s).
-   **Duplicar Columna (Duplicate Column):** Crea una copia de la columna.
-   **Cambiar Tipo (Change Type):** Permite forzar la conversi√≥n de la columna a un tipo de dato espec√≠fico (ej. de Texto a Fecha).
-   **Transformar (Transform):** Aplica una transformaci√≥n in-situ a la columna actual (ej. convertir a may√∫sculas, recortar espacios, calcular logaritmo).
-   **Agregar Columna (Add Column from Examples):** Permite crear una nueva columna a partir de ejemplos, donde Power Query infiere la l√≥gica de transformaci√≥n.

**Ejemplo Pr√°ctico:** Un analista tiene una columna con nombres y apellidos. Hace clic derecho en el encabezado, elige "Dividir Columna" > "Por delimitador", introduce un espacio como delimitador y Power Query crea autom√°ticamente dos nuevas columnas: "Nombre" y "Apellido".

#### Operaciones de Filtro

Cada encabezado de columna contiene un icono de flecha hacia abajo que abre un men√∫ de filtro, similar al de Excel, pero mucho m√°s potente.

**Definici√≥n:** Es una interfaz que permite a los usuarios seleccionar o deseleccionar valores √∫nicos de una lista o aplicar filtros l√≥gicos para incluir o excluir filas basadas en condiciones.

**Importancia Estrat√©gica:** Es la herramienta fundamental para reducir el conjunto de datos y trabajar solo con la informaci√≥n relevante. Los filtros aplicados se convierten en pasos documentados y repetibles, garantizando la consistencia.

**Tipos de Filtros:**
-   **Filtros de Selecci√≥n:** Marcar o desmarcar valores de una lista (se carga una vista previa de los valores).
-   **Filtros L√≥gicos:** Dependen del tipo de dato. Para texto: "Comienza con", "Contiene", "No contiene". Para n√∫meros: "Mayor que", "Menor o igual que", "Est√° entre". Para fechas: "En el a√±o anterior", "Este mes", "Entre".

**Ejemplo Pr√°ctico:** Para analizar solo las ventas del a√±o actual, un usuario hace clic en el filtro de la columna "Fecha de Pedido", va a "Filtros de fecha y hora" y selecciona "En el a√±o" > "este a√±o". Power Query genera el paso de filtrado correspondiente.

### Indicadores Visuales de Calidad de Datos

Justo debajo del encabezado de cada columna, Power Query proporciona una barra de calidad de datos que ofrece un resumen visual instant√°neo.

-   **Barra de Calidad:** Una barra de color que muestra la proporci√≥n de valores v√°lidos (verde), con errores (rojo) y vac√≠os (gris).
-   **Perfil de Columna:** Al pasar el rat√≥n sobre la barra, se muestra un resumen estad√≠stico: recuento de filas, errores, vac√≠os, valores distintos y √∫nicos.
-   **Distribuci√≥n de Valores:** Un peque√±o histograma que visualiza la distribuci√≥n de los valores en la columna.

**Importancia Estrat√©gica:** Estos indicadores permiten una evaluaci√≥n de la calidad de los datos de un solo vistazo, ayudando a los analistas a identificar problemas potenciales (ej. una columna clave con un alto porcentaje de valores nulos) de forma proactiva.

## Panel de Propiedades (Pasos Aplicados)

El panel de "Pasos Aplicados", situado a la derecha en la interfaz del Editor de Power Query, es una de sus caracter√≠sticas m√°s potentes y definitorias. Funciona como un historial grabado de cada transformaci√≥n realizada en una consulta, proporcionando transparencia, repetibilidad y una enorme flexibilidad para la edici√≥n.

### Concepto de Pasos Secuenciales

Cada acci√≥n realizada a trav√©s de la interfaz gr√°fica ‚Äîdesde la conexi√≥n a la fuente hasta el √∫ltimo filtro o cambio de formato‚Äî se registra como un paso descriptivo en esta lista. Los pasos se ejecutan en orden, desde arriba hacia abajo, construyendo el resultado final de la consulta.

**Definici√≥n:** Un "paso aplicado" es un registro inmutable de una transformaci√≥n de datos espec√≠fica. Cada paso se traduce en una expresi√≥n en el lenguaje M y se basa en el resultado del paso anterior.

**Importancia Estrat√©gica:**
-   **Auditabilidad y Transparencia:** Permite a cualquier usuario (o a uno mismo en el futuro) entender exactamente c√≥mo se han transformado los datos, desde el origen hasta el resultado final.
-   **Repetibilidad:** Garantiza que la misma secuencia de transformaciones se aplique de forma id√©ntica cada vez que se actualizan los datos, eliminando el trabajo manual y los errores.
-   **Flexibilidad de Edici√≥n:** Permite modificar, reordenar o eliminar pasos en cualquier punto del proceso sin tener que empezar desde cero.

**Ejemplo de Flujo:**
1.  **Source:** Conexi√≥n al archivo Excel.
2.  **Navigation:** Selecci√≥n de una tabla espec√≠fica dentro del archivo.
3.  **Promoted Headers:** Se usa la primera fila como encabezados de columna.
4.  **Filtered Rows:** Se eliminan las filas donde las ventas son cero.
5.  **Changed Type:** Se convierte la columna de fecha de texto a tipo de dato Fecha.

### Interacci√≥n con los Pasos

Este panel no es solo una lista est√°tica; es completamente interactivo.

-   **Seleccionar un Paso:** Al hacer clic en un paso, el √Årea de Vista Previa muestra el estado de los datos *en ese punto* del proceso. Esto es invaluable para depurar y entender el efecto de una transformaci√≥n espec√≠fica.
-   **Renombrar un Paso:** Por defecto, los pasos tienen nombres gen√©ricos (ej. "Filtered Rows"). Se pueden renombrar (haciendo clic derecho > Renombrar) para hacerlos m√°s descriptivos (ej. "Filtrar Ventas sin Importe"). Esto es una pr√°ctica excelente para la documentaci√≥n.
-   **Eliminar un Paso:** Se puede eliminar un paso intermedio haciendo clic en la "X" a su izquierda. Power Query advertir√° si esto puede romper pasos posteriores que dependan de √©l.
-   **Reordenar Pasos:** Es posible arrastrar y soltar pasos para cambiar su orden de ejecuci√≥n, aunque debe hacerse con cuidado para no alterar la l√≥gica de la consulta.
-   **Editar Configuraci√≥n del Paso:** Muchos pasos tienen un icono de engranaje (‚öôÔ∏è) a su derecha. Al hacer clic en √©l, se abre el cuadro de di√°logo original que gener√≥ el paso, permitiendo modificar su configuraci√≥n. Por ejemplo, se puede editar un paso de filtro para cambiar la condici√≥n sin tener que eliminarlo y crearlo de nuevo.

### El Lenguaje M (Bajo el Cap√≥)

Cada paso en la lista es una representaci√≥n amigable de una l√≠nea o bloque de c√≥digo en el lenguaje M de Power Query.

**Definici√≥n:** M es el lenguaje de f√≥rmulas funcional y sensible a may√∫sculas y min√∫sculas que impulsa a Power Query. La interfaz gr√°fica escribe este c√≥digo por el usuario.

**Importancia Estrat√©gica:** Aunque se puede hacer mucho sin escribir una sola l√≠nea de c√≥digo, entender que M existe es crucial. Para transformaciones muy complejas o personalizadas, se puede acceder al **Editor Avanzado** (desde la pesta√±a "Inicio" o el men√∫ contextual de la consulta) para ver y editar directamente el script M completo. Esto desbloquea todo el potencial de Power Query.

**Ejemplo Pr√°ctico:** Un analista quiere revisar por qu√© algunos totales parecen incorrectos. En el panel de "Pasos Aplicados", hace clic en el paso llamado "Removed Columns" para asegurarse de que no elimin√≥ accidentalmente una columna necesaria para el c√°lculo. Luego, selecciona el paso "Filtered Rows" y hace clic en el engranaje para verificar que la l√≥gica del filtro es correcta. Finalmente, renombra el paso a "Filtrar pedidos de prueba" para que su prop√≥sito sea m√°s claro para sus compa√±eros de equipo.

## Cinta de Opciones

### Pesta√±a Inicio
#### Administrar Consultas
- **Cerrar y aplicar**: Finalizar edici√≥n
- **Actualizar vista previa**: Refrescar datos
- **Opciones de consulta**: Configuraciones

#### Nuevas Consultas
- **Nuevo origen**: Conectar nueva fuente
- **Consultas recientes**: Acceso r√°pido
- **Consulta en blanco**: Crear desde cero

#### Reducir Filas
- **Quitar filas superiores**: Eliminar N filas del inicio
- **Quitar filas inferiores**: Eliminar N filas del final
- **Quitar filas duplicadas**: Deduplicaci√≥n
- **Mantener filas**: Conservar solo N filas

### Pesta√±a Transformar
#### Tabla
- **Usar primera fila como encabezados**
- **Transponer**: Intercambiar filas y columnas
- **Invertir filas**: Cambiar orden de filas

#### Columnas de Texto
- **Formato**: May√∫sculas, min√∫sculas, t√≠tulo
- **Combinar**: Unir m√∫ltiples columnas
- **Dividir columna**: Separar por delimitador
- **Extraer**: Extraer caracteres espec√≠ficos

#### Columnas de N√∫mero
- **Estad√≠sticas**: Suma, promedio, mediana
- **Est√°ndar**: Redondear, valor absoluto
- **Informaci√≥n**: Signo, ra√≠z cuadrada

### Pesta√±a Agregar Columna
#### General
- **Columna personalizada**: F√≥rmula M personalizada
- **Invocar funci√≥n personalizada**: Usar funci√≥n propia
- **Columna condicional**: L√≥gica if-then-else

#### Desde Ejemplos
- **Desde ejemplos**: ML para detectar patrones
- **Desde selecci√≥n**: Basado en muestra seleccionada

#### Texto
- **Longitud**: N√∫mero de caracteres
- **Extraer**: Extraer partes espec√≠ficas
- **Formato**: Aplicar formato espec√≠fico

### Pesta√±a Ver
#### Opciones de Vista
- **Errores de consulta**: Mostrar consultas con errores
- **Calidad de columna**: Mostrar estad√≠sticas de calidad
- **Distribuci√≥n de columna**: Mostrar distribuci√≥n de valores
- **Perfil de columna**: An√°lisis detallado de columna

#### Layout
- **Mostrar esquema**: Vista de estructura de datos
- **Ir a columna**: Navegaci√≥n r√°pida
- **Pantalla completa**: Maximizar √°rea de trabajo

## Editor Avanzado

### Acceso al C√≥digo M
```
Ver ‚Üí Editor avanzado
```

### Estructura de Consulta M
```m
let
    // Paso 1: Definir origen
    Source = Excel.Workbook(File.Contents("C:\datos.xlsx")),
    
    // Paso 2: Seleccionar hoja
    Sheet1 = Source{[Item="Sheet1",Kind="Sheet"]}[Data],
    
    // Paso 3: Promover encabezados
    Headers = Table.PromoteHeaders(Sheet1),
    
    // Paso 4: Cambiar tipos
    ChangeType = Table.TransformColumnTypes(Headers, {
        {"Fecha", type date},
        {"Ventas", type number}
    })
in
    ChangeType
```

### Elementos del Lenguaje M
- **let...in**: Estructura principal
- **Variables**: Almacenan resultados intermedios
- **Funciones**: Operaciones sobre datos
- **Tipos**: Definici√≥n de tipos de datos
- **Comentarios**: Documentaci√≥n inline

## Configuraciones y Opciones

### Opciones de Consulta
```
Archivo ‚Üí Opciones y configuraci√≥n ‚Üí Opciones de consulta
```

#### Seguridad
- **Niveles de privacidad**: P√∫blico, organizacional, privado
- **Certificados**: Validaci√≥n SSL
- **Firewall**: Configuraci√≥n de proxy

#### Editor
- **Idioma de f√≥rmula**: M language
- **IntelliSense**: Autocompletado
- **Formato**: Sangr√≠a y espaciado

### Configuraci√≥n de Fuentes de Datos
#### Credenciales
- **Windows**: Autenticaci√≥n integrada
- **Base de datos**: Usuario y contrase√±a
- **Web**: API keys, OAuth
- **Archivo**: Ubicaci√≥n y permisos

#### Opciones Avanzadas
- **Tiempo de espera**: Timeout para consultas
- **Tama√±o de lote**: Filas por lote
- **Modo de conector**: Import vs DirectQuery

## Diagn√≥stico y Optimizaci√≥n

### Herramientas de An√°lisis
#### Query Diagnostics
```
Herramientas ‚Üí Diagn√≥sticos de consulta ‚Üí Iniciar diagn√≥stico
```

**Informaci√≥n proporcionada:**
- Tiempo de ejecuci√≥n por paso
- Uso de memoria
- Operaciones de base de datos
- Query folding efectivo

#### Vista de Dependencias
```
Ver ‚Üí Dependencias de consulta
```

**Beneficios:**
- Visualizar relaciones entre consultas
- Identificar consultas hu√©rfanas
- Optimizar orden de procesamiento

### Optimizaci√≥n de Rendimiento
#### Query Folding
**Indicadores:**
- **Icono de vista previa** en pasos aplicados
- **"View Native Query"** en men√∫ contextual
- **An√°lisis de dependencias**

#### Mejores Pr√°cticas
1. **Filtrar temprano**: Aplicar filtros al inicio
2. **Seleccionar columnas necesarias**: Reducir ancho de datos
3. **Evitar pasos costosos**: Minimizar pivotes complejos
4. **Usar tipos correctos**: Optimizar almacenamiento

## Patrones Comunes de Uso

### Limpieza de Datos
```
1. Quitar filas nulas
2. Estandarizar formatos
3. Corregir tipos de datos
4. Eliminar duplicados
5. Validar rangos de valores
```

### Transformaci√≥n de Estructura
```
1. Transponer datos
2. Pivotear/Despivotear
3. Dividir columnas
4. Combinar tablas
5. Crear jerarqu√≠as
```

### Enriquecimiento de Datos
```
1. Agregar columnas calculadas
2. Buscar valores relacionados
3. Aplicar l√≥gica condicional
4. Calcular estad√≠sticas
5. Generar rankings
```

## Soluci√≥n de Problemas

### Errores Comunes
#### "DataFormat.Error"
- **Causa**: Tipo de datos incorrecto
- **Soluci√≥n**: Revisar y corregir tipos

#### "Expression.Error"
- **Causa**: F√≥rmula M inv√°lida
- **Soluci√≥n**: Verificar sintaxis en editor avanzado

#### "DataSource.Error"
- **Causa**: Problema de conectividad
- **Soluci√≥n**: Verificar credenciales y conectividad

### Debugging
#### Estrategias
1. **Aislar pasos**: Deshabilitar pasos gradualmente
2. **Revisar datos intermedios**: Analizar cada paso
3. **Usar try...otherwise**: Manejo de errores
4. **Validar tipos**: Asegurar consistencia

## Conclusi√≥n

El Editor de Power Query es una herramienta poderosa que combina facilidad de uso con capacidades avanzadas de transformaci√≥n. Su interfaz visual permite a usuarios de diferentes niveles t√©cnicos preparar datos efectivamente, mientras que su motor subyacente de lenguaje M proporciona flexibilidad ilimitada para casos de uso complejos.

El dominio de esta herramienta es fundamental para crear soluciones de BI robustas y eficientes, ya que la calidad de los datos transformados impacta directamente en la efectividad de los an√°lisis posteriores.
